# Простая инструкция для пустого Ubuntu сервера

## Шаг 1: Скопируй и выполни эту команду

```bash
curl -s https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.7/install.sh | bash && \
source ~/.bashrc && \
nvm install 20 && \
nvm use 20 && \
sudo apt update && \
sudo apt install -y git nginx postgresql postgresql-contrib && \
sudo npm install -g pm2
```

## Шаг 2: Настрой базу данных

```bash
sudo -u postgres createuser --interactive --pwprompt hns_user
# Введи пароль: MySecurePass123
# На вопросы отвечай: n, n, n

sudo -u postgres createdb -O hns_user hns_studio
```

## Шаг 3: Создай директорию проекта

```bash
sudo mkdir -p /var/www/hns-studio
sudo chown $USER:$USER /var/www/hns-studio
cd /var/www/hns-studio
```

## Шаг 4: Загрузи файлы проекта

Вариант А - если есть git репозиторий:
```bash
git clone https://your-repo-url.git .
```

Вариант Б - загрузи файлы вручную через SCP/SFTP

## Шаг 5: Настрой проект

```bash
# Создай .env файл
cat > .env << EOF
NODE_ENV=production
PORT=3000
DATABASE_URL=postgresql://hns_user:MySecurePass123@localhost:5432/hns_studio
EOF

# Установи зависимости
npm install

# Собери проект  
npm run build
```

## Шаг 6: Настрой Nginx

```bash
# Создай конфиг (замени your-domain.com на свой домен)
sudo tee /etc/nginx/sites-available/your-domain.com << EOF
server {
    listen 80;
    server_name your-domain.com www.your-domain.com;

    location / {
        proxy_pass http://localhost:3000;
        proxy_set_header Host \$host;
        proxy_set_header X-Real-IP \$remote_addr;
        proxy_set_header X-Forwarded-For \$proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto \$scheme;
    }
}
EOF

# Активируй сайт
sudo ln -s /etc/nginx/sites-available/your-domain.com /etc/nginx/sites-enabled/
sudo rm -f /etc/nginx/sites-enabled/default
sudo nginx -t
sudo systemctl restart nginx
```

## Шаг 7: Запусти приложение

```bash
# Создай PM2 конфиг
cat > ecosystem.config.js << EOF
module.exports = {
  apps: [{
    name: 'hns-studio',
    script: 'server/index.ts',
    interpreter: 'npx',
    interpreter_args: 'tsx',
    env: {
      NODE_ENV: 'production',
      PORT: 3000
    }
  }]
};
EOF

# Запусти
pm2 start ecosystem.config.js
pm2 save
pm2 startup
```

## Шаг 8: Получи SSL (опционально)

```bash
sudo apt install certbot python3-certbot-nginx
sudo certbot --nginx -d your-domain.com
```

## Готово!

Твой сайт должен работать на http://your-domain.com

### Если что-то не работает:

```bash
# Проверь статус
pm2 status
pm2 logs hns-studio

# Проверь Nginx
sudo systemctl status nginx
sudo nginx -t

# Проверь базу данных
sudo systemctl status postgresql
```